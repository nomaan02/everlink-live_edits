<style>
  #newsletter-{{ section.id }} {
    background-color: {{ section.settings.background_color }};
    color: {{ section.settings.text_color }};
  }

  #newsletter-{{ section.id }} .newsletter__input {
    border-color: {{ section.settings.text_color | color_modify: 'alpha', 0.3 }};
  }

  #newsletter-{{ section.id }} .newsletter__input::placeholder {
    color: {{ section.settings.text_color | color_modify: 'alpha', 0.6 }};
  }
</style>

<section id="newsletter-{{ section.id }}" class="newsletter section" data-section-id="{{ section.id }}" data-section-type="newsletter">
  <div class="container">
    {%- if section.settings.heading != blank -%}
      <h2 class="newsletter__heading">{{ section.settings.heading }}</h2>
    {%- endif -%}

    {%- if section.settings.subtext != blank -%}
      <p class="newsletter__subtext">{{ section.settings.subtext }}</p>
    {%- endif -%}

    {%- form 'customer', class: 'newsletter__form' -%}
      {%- if form.posted_successfully? -%}
        <div class="newsletter__success" role="status">
          <p>{{ 'newsletter.success' | t: default: 'Thank you for subscribing!' }}</p>
        </div>
      {%- endif -%}

      {%- if form.errors -%}
        <div class="newsletter__error" role="alert">
          <p>{{ form.errors.messages['email'] }}</p>
        </div>
      {%- endif -%}

      <input type="hidden" name="contact[tags]" value="newsletter">

      <div class="newsletter__fields">
        <input
          type="email"
          name="contact[email]"
          id="newsletter-email-{{ section.id }}"
          class="newsletter__input"
          placeholder="{{ 'newsletter.placeholder' | t: default: 'Enter your email' }}"
          aria-label="{{ 'newsletter.placeholder' | t: default: 'Enter your email' }}"
          required
          autocomplete="email"
        >

        <button type="submit" class="btn btn-primary" name="commit">
          {{ section.settings.button_text }}
        </button>
      </div>
    {%- endform -%}
  </div>
</section>

{% schema %}
{
  "name": "Newsletter",
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Join the Everlink Community"
    },
    {
      "type": "textarea",
      "id": "subtext",
      "label": "Subtext",
      "default": "Be the first to know about new collections and the stories behind them"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Submit Button Text",
      "default": "Subscribe"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#E0BFB8"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#FFFFFF"
    }
  ],
  "presets": [
    {
      "name": "Newsletter"
    }
  ]
}
{% endschema %}
